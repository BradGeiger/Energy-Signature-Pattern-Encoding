Представленный код реализует класс `EnergySignature` для вычисления «энергетического сигнатура» физического поля — компактного числового представления, включающего:

- полный угловой момент системы;
- полную энергию;
- коэффициенты разложения по сферическим гармоникам.

### Основные компоненты класса

1. **Инициализация** (`__init__`):  
   Задаёт центр системы `r0` и опорное время `t0`.

2. **Установка полей** (`set_energy_field`, `set_current_field`):  
   Принимают функции, описывающие:
   - плотность энергии $u(\mathbf{s}, t)$;
   - поток энергии $\mathbf{J}(\mathbf{s}, t)$.

3. **Вычисление скорости** (`compute_velocity_field`):  
   $$
   \mathbf{v}(\mathbf{s}, t) = \frac{\mathbf{J}(\mathbf{s}, t)}{u(\mathbf{s}, t)}
   $$  
   С защитой от деления на ноль.

4. **Угловой момент** (`compute_angular_momentum`):  
   Интеграл по объёму:  
   $$
   \mathbf{L}(t_0) = \iiint \mathbf{s} \times \mathbf{J}(\mathbf{s}, t_0) \, d^3s
   $$

5. **Радиальный профиль энергии** (`radial_energy_profile`):  
   Интеграл по сферической поверхности радиуса $r$:  
   $$
   U(r) = \int_0^{2\pi} \int_0^\pi u(\mathbf{s}, t_0) \, r^2 \sin\theta \, d\theta \, d\phi
   $$

6. **Разложение по сферическим гармоникам** (`spherical_harmonic_expansion`):  
   Коэффициенты:  
   $$
   c_{lm} = \int_0^{2\pi} \int_0^\pi u(\mathbf{s}, t_0) \, Y_{lm}^*(\phi, \theta) \, \sin\theta \, d\theta \, d\phi
   $$  
   где $Y_{lm}$ — сферические гармоники.

7. **Формирование сигнатуры** (`compute_signature`):  
   Вектор, содержащий:
   - 3 компонента $\mathbf{L}$;
   - полную энергию $E_{\text{total}}$;
   - действительные и мнимые части $c_{lm}$ для $l \leq l_{\text{max}}$.

8. **Нормализация** (`normalize_signature`):  
   Делит вектор на $|E_{\text{total}}|$ для инвариантности к масштабу энергии.

9. **Кодирование** (`encode_signature`):  
   Преобразует вектор в строку с заданной точностью.

### Пример использования

В блоке `if __name__ == "__main__":` демонстрируется:

1. Создание объекта `EnergySignature`.
2. Задание тестовых полей:
   - Гауссова плотность энергии: $u(\mathbf{s}) = e^{-|\mathbf{s}|^2/2}$;
   - Вращающийся поток: $\mathbf{J} = (-y e^{-|\mathbf{s}|^2/2}, x e^{-|\mathbf{s}|^2/2}, 0)$.
3. Вычисление и вывод:
   - исходного сигнатурного вектора;
   - нормализованного вектора;
   - закодированной строки;
   - полного углового момента.

### Зависимости

- `numpy` — численные вычисления;
- `scipy.special.sph_harm` — сферические гармоники;
- `scipy.integrate.tplquad`, `dblquad` — многомерные интегралы;
- `matplotlib` — визуализация (не используется в примере).

### Возможные улучшения

1. Добавить проверку сходимости интегралов.
2. Реализовать кэширование промежуточных результатов.
3. Добавить визуализацию радиального профиля и сферических гармоник.
4. Поддерживать параллельные вычисления для интегралов.
